<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8">
<title>Funbox - C치psula Prototipo Detallada</title>
<style>
  body { margin:0; overflow:hidden; background: #1a1a1a; }
  #ui {
    position: fixed; top:20px; left:20px; color:white;
    font-family: 'Segoe UI', sans-serif;
    background: rgba(0, 0, 0, 0.7);
    padding:15px; border-radius:10px; z-index:10;
    border-left: 5px solid #00f2ff;
  }
</style>
</head>
<body>

<div id="ui">
  游뱄 **C치psula de Desarrollo: Funbox v2.0**<br>
  WASD: Moverse | **MANT칄N R: Vista Frontal (F5)**<br>
  <small>Dise침o: Simple, Limpio, Detallado</small>
</div>

<script src="https://cdn.jsdelivr.net/npm/three@0.160.0/build/three.min.js"></script>
<script>
// 1. ESCENA T칄CNICA
const scene = new THREE.Scene();
scene.background = new THREE.Color(0x222222);
const camera = new THREE.PerspectiveCamera(75, window.innerWidth/window.innerHeight, 0.1, 1000);
const renderer = new THREE.WebGLRenderer({antialias:true});
renderer.setSize(window.innerWidth, window.innerHeight);
renderer.shadowMap.enabled = true;
document.body.appendChild(renderer.domElement);

// ILUMINACI칍N DE ESTUDIO
const ambient = new THREE.AmbientLight(0xffffff, 0.5);
scene.add(ambient);
const light1 = new THREE.PointLight(0x00f2ff, 1, 50); // Luz tecnol칩gica azul
light1.position.set(5, 5, 5);
scene.add(light1);
const light2 = new THREE.DirectionalLight(0xffffff, 0.8);
light2.position.set(-5, 10, 2);
light2.castShadow = true;
scene.add(light2);

// SUELO DE REJILLA (GRID) - Estilo desarrollo
const grid = new THREE.GridHelper(200, 50, 0x444444, 0x333333);
scene.add(grid);
const floor = new THREE.Mesh(
  new THREE.PlaneGeometry(200, 200),
  new THREE.MeshStandardMaterial({color: 0x111111})
);
floor.rotation.x = -Math.PI/2;
floor.receiveShadow = true;
scene.add(floor);

// 2. EL PERSONAJE (C츼PSULA DETALLADA)
const player = new THREE.Group();
player.position.y = 1; 

// MATERIALES
const matCapsula = new THREE.MeshStandardMaterial({
  color: 0xeeeeee, 
  roughness: 0.2, 
  metalness: 0.5
});
const matVisor = new THREE.MeshStandardMaterial({color: 0x111111, roughness: 0.1});
const matLuz = new THREE.MeshBasicMaterial({color: 0x00f2ff});

// CUERPO (C치psula de juego)
const capsule = new THREE.Mesh(
  new THREE.CapsuleGeometry(0.5, 1, 4, 16), 
  matCapsula
);
capsule.castShadow = true;
player.add(capsule);

// VISOR (Para que se sepa hacia d칩nde mira)
const visor = new THREE.Mesh(
  new THREE.CapsuleGeometry(0.35, 0.1, 4, 16),
  matVisor
);
visor.rotation.z = Math.PI/2;
visor.position.set(0, 0.5, 0.3);
player.add(visor);

// OJOS LED (Detalle tecnol칩gico)
const eyeGeo = new THREE.SphereGeometry(0.05, 16, 16);
const leftEye = new THREE.Mesh(eyeGeo, matLuz);
leftEye.position.set(-0.15, 0.5, 0.45);
const rightEye = new THREE.Mesh(eyeGeo, matLuz);
rightEye.position.set(0.15, 0.5, 0.45);
player.add(leftEye, rightEye);

// BASE MEC츼NICA (Para que no sea solo una c치psula flotante)
const base = new THREE.Mesh(
  new THREE.CylinderGeometry(0.51, 0.51, 0.1, 16),
  matVisor
);
base.position.y = -0.5;
player.add(base);

scene.add(player);

// 3. LOGICA DE CONTROL
const keys = {};
let yaw = 0;
let step = 0;

window.addEventListener("keydown", e => keys[e.key.toLowerCase()] = true);
window.addEventListener("keyup", e => keys[e.key.toLowerCase()] = false);
document.body.onclick = () => document.body.requestPointerLock();
document.addEventListener("mousemove", e => {
  if(document.pointerLockElement) yaw -= e.movementX * 0.003;
});

// 4. ANIMACI칍N
function animate() {
  requestAnimationFrame(animate);
  
  let dir = new THREE.Vector3();
  let moving = false;
  if(keys.w) { dir.z -= 1; moving = true; }
  if(keys.s) { dir.z += 1; moving = true; }
  if(keys.a) { dir.x -= 1; moving = true; }
  if(keys.d) { dir.x += 1; moving = true; }

  if(moving) {
    const moveDir = dir.normalize().applyAxisAngle(new THREE.Vector3(0,1,0), yaw);
    player.position.addScaledVector(moveDir, 0.12);
    player.rotation.y = yaw + Math.PI;
    
    // Inclinaci칩n aerodin치mica al correr
    step += 0.2;
    capsule.rotation.x = Math.sin(step) * 0.05 + 0.1; 
  } else {
    // Respiraci칩n Idle
    step += 0.05;
    player.position.y = 1 + Math.sin(step) * 0.02;
    capsule.rotation.x = 0;
  }

  // C츼MARA TIPO F5 (Minecraft)
  let camTarget;
  if (keys.r) {
    // Mirar de frente
    camTarget = new THREE.Vector3(0, 1.5, 4).applyAxisAngle(new THREE.Vector3(0,1,0), yaw + Math.PI);
  } else {
    // Mirar desde atr치s
    camTarget = new THREE.Vector3(0, 2, 5).applyAxisAngle(new THREE.Vector3(0,1,0), yaw);
  }

  camera.position.lerp(player.position.clone().add(camTarget), 0.1);
  camera.lookAt(player.position.clone().add(new THREE.Vector3(0, 0.5, 0)));

  renderer.render(scene, camera);
}
animate();

window.addEventListener("resize", () => {
  camera.aspect = window.innerWidth/window.innerHeight;
  camera.updateProjectionMatrix();
  renderer.setSize(window.innerWidth, window.innerHeight);
});
</script>
</body>
</html>
